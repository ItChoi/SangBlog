<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.blog.sang.manager.menu.mapper.MenuManagerMapper">
	<resultMap id="MenuREsult" type="com.blog.sang.manager.menu.domain.Menu">
		<id property="id" column="ID" />
		<result property="parentId" column="PARENT_ID"/>
		<result property="menuLevel" column="MENU_LEVEL"/>
		<result property="menuCode" column="MENU_CODE"/>
		<result property="menuName" column="MENU_NAME"/>
		<result property="ordering" column="ORDERING"/>
		<result property="url" column="URL"/>
		<result property="uri" column="URI"/>
	</resultMap>
	
	<sql id="AllMenuColumn">
		MM.ID,
		MM.PARENT_ID,
		MM.MENU_LEVEL,
		MM.MENU_CODE,
		MM.MENU_NAME,
		MM.ORDERING,
		MM.URL,
		MM.URI
	</sql>
	
	<select id="getAllOneMenu" resultMap="MenuREsult">
		SELECT
			<include refid="AllMenuColumn" />
		FROM
			MANAGER_MENU MM
		WHERE
			PARENT_ID IS NULL
		ORDER BY ORDERING
	</select>
	
	<select id="getMenuByParentId">
		SELECT
			<include refid="AllMenuColumn" />
		FROM
			MANAGER_MENU MM
		WHERE
			PARENT_ID = #{parentId}
		UNION
		SELECT
			<include refid="AllMenuColumn" />
		FROM
			MANAGER_MENU MM,
			(
				SELECT
					ID,
				FROM
					MANAGER_MENU
				WHERE
					PARENT_ID = #{parentId}
			) MMM
		WHERE
			MM.PARENT_ID = MMM.ID
		order by menu_level, ordering
			
			
	</select>
	
	
</mapper>